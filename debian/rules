#!/usr/bin/make -f
# -*- makefile -*-

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1


UVERSION := $(shell ./setup.py --version)
VERSION := $(shell dpkg-parsechangelog | sed -n -e 's/^Version: //p' | sed -e 's/^[[:digit:]]*://' -e 's/[-].*//')
#export PYBUILD_NAME = deejayd
export PYBUILD_DISABLE=test


%:
	dh $@ --with python3 --buildsystem=pybuild

override_dh_install:
	# Fixing example conffile location as dh_install cannot rename
	mkdir -p $(CURDIR)/debian/tmp/etc
	cp -a $(CURDIR)/deejayd/ui/defaults.conf\
	      $(CURDIR)/debian/tmp/etc/deejayd.conf

	dh_install

orig_source:
	./setup.py sdist
	mv dist/deejayd-$(UVERSION).tar.gz ../deejayd_$(VERSION).orig.tar.gz
	rmdir dist
